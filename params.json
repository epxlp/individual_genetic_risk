{
  "name": "Calculating an Individual's Genetic Risk",
  "tagline": "from association to prediction",
  "body": "There are many ways in which you can estimate an individual’s risk of a particular disease or predict their likely trait value. How you do this will depend on the trait, the circumstances of the individual and the reason for wanting to make such a prediction.\r\n\r\nIn today’s session we will demonstrate estimating risk and predicting trait values in a variety of settings using different types of information.\r\n\r\n\r\n# The data\r\nBecause we have our genes from birth, we could use an individual’s genetic data to estimate their risk having a certain disease later in life. In practice you might be more interested in doing this for cancer or heart disease, but we’ll do this for a trait that you have data for: **BMI/obesity**.\r\n\r\n# Recapping association results\r\nIn the GWAS exercise in unit 2 you found a number of genetic variants associated with BMI. \r\nLet’s start by reminded ourselves of the association evidence between being BMI and the associated SNPs.\r\n\r\n\r\n| CHR\t| SNP\t| A1\t| BETA\t| A1_freq\t| var_exp\t| OR\t| STAT\t| P |\r\n| ---\t| ---\t| ---\t| ---\t| ---\t| ---\t| ---\t| ---\t| --- |\r\n| 1\t| rs12748679\t| C\t| -0.5972\t| \t| 0.0038\t| \t| -6.42\t| 1.4e-10 |\r\n| 1\t| rs630372\t| A\t| 0.6878\t| \t| \t| \t| 7.831\t| 5.4e-15 |\r\n| 2\t| rs2867125\t| T\t| -0.6013\t| \t| \t| \t| -6.04\t| 2.2e-8 |\r\n| 4\t| rs13130484\t| T\t| 0.4853\t| \t| \t| \t| 6.391\t| 1.7e-10 |\r\n| 8\t| rs2920930\t| T\t| -0.4611\t| \t| \t| \t| -5.604\t| 2.2e-8 |\r\n| 16\t| rs8050136\t| A\t| 0.5906\t| \t| \t| \t| 7.702\t| 1.5e-14 |\r\n| 18\t| rs571312\t| A\t| 0.9928\t| \t| \t| \t| 11.26\t| 3.3e-29 |  \r\n\r\n<br><br>\r\n> **Task: Examine the strength of the evidence for the association (P-value), the magnitude of the association (beta/OR) and the variance in BMI explained for each of these SNPs, that you estimated in unit 2.  \r\nHow convinced are you that these variants are associated with BMI/being overweight?**\r\n\r\n<br><br>\r\nSome of these are very strong associations. p=3e-29 is extremely strong evidence of an association. Despite this the effect sizes and the variance explained are quite small {elaborate}. In unit 2 you estimated that the total variance explained for these 7 SNPs was 4%. \r\n\r\n<br><br>\r\n> **Question: These variants are all associated with being overweight, but what do you think determines how good a variant is for prediction?**\r\n\r\n<br><br>\r\n**BUT – these only tell us how useful a genotype is ‘on average’ in the population. How useful a genotype is for prediction for an individual also depends on the individual’s genotype.\r\nSome variants might have very large effect, but be extraordinarily rare. This variant would have a low variance explained, but for someone who had this genotype, this would be very informative. Discuss this with a neighbour**\r\n\r\n# Generating a genetic risk score\r\n\r\nUse these commands to extract the 7 SNPs and generate a risk score for each person in the sample:\r\n\r\n```\r\nplink --bfile geno_raw --extract snps_for_score.txt –recode A --out BMI_snps\r\nplink --bfile geno_raw --score snps_for_score.txt --out BMI_score\r\n```\r\n\r\nNow we will load the data into R\r\n\r\n```\r\nsnps <- read.table(\"~/ibsc_unit2/data/BMI_snps.raw”, header=T)\r\nscore <- read.table(“~/ibsc_unit2/data/BMI_score.profile”, header=T)\r\nphen <- read.table(“~/ibsc_unit2/data/phen_clean.txt”)\r\n```\r\nRun the following commands to investigate the distribution of the genetic risk score\r\n```\r\nBMI_score <- score$CNT2\r\nhist(BMI_score)\r\nhist(BMI_score[phen$BMIcat==\"underweight\" | phen$BMIcat==\"healthy\"], col=rgb(1,0,0,0.5), xlim=c(0,14), ylim=c(0,600), main = \"BMI categories\", xlab=\"genetic_score\")\r\nhist(BMI_score[phen$BMIcat==\"obese\"], col=rgb(0,0,1,0.5), add=T)\r\n```\r\n\r\n# Population-level predictions\r\n\r\nWhat is the difference in obesity risk between those in the top 5% and bottom 5% of the score?\r\n```\r\nquantile(BMI_score, c(.05, .95))\r\nsum(phen$BMIcat==\"obese\" & BMI_score<5)/sum(BMI_score<5)\r\nsum(phen$BMIcat==\"obese\" & BMI_score>10)/sum(BMI_score>10)\r\n```\r\n\r\nThere seems to be quite a significant difference in risk. Those in the bottom 5% of the risk score have only a 30% risk of being obese, whilst those in the top 5% of the risk score have a 60% risk of being obese.\r\n\r\n<br><br>\r\n> **Question: Do you think it would be an economically effective strategy to target an intervention only at children that were in the top 5% of the risk score?  \r\nAlthough this is unlikely to happen for an outcome such as BMI, think about if the outcome were cancer or Alzheimer’s disease.  \r\nDiscuss this with a neighbour**\r\n\r\n<br><br>\r\n**As a genetic risk score increases there is a sliding scale of increased risk, but any health policies would likely have to define a threshold and this would have sensitivity and specificity implications.**\r\n\r\n# Individual level prediction\r\n\r\nThere’s clearly a difference in the genetic_score distribution between healthy and underweight versus obese individuals. However, if I told you someone had a genetic score of 4, what would that tell you?\r\n\r\n```\r\ntable (BMI_score, phen$BMIcat)\r\nsummary(phen$BMI[BMI_score==4])\r\nboxplot(phen$BMI~BMI_score)\r\n```\r\n\r\nOf 335 people in this category: 7% are underweight, 27% are healthy, 35% are overweight, 32% are obese. So you might say that they are quite likely to be overweight or obese, but the range of BMIs for people in this category is very wide (11.5 to 43.3), so it would be difficult to predict their BMI with any accuracy.\r\n\r\n\r\nCompare the mean BMIs of people at the top and bottom of the central 90%\r\n```\r\nquantile(BMI_score, c(.05, .95))\r\nsummary(phen$BMI[BMI_score==5])\r\nsummary(phen$BMI[BMI_score==10])\r\n```\r\n\r\n90% of people fall between BMI_scores of 5 and 10, the mean BMI difference between the top and bottom of this range is: 2.81kg/m2 BMI=30 versus BMI=27. \r\n\r\n<br><br>\r\n> **For the majority of people knowing your BMI score is very useful / somewhat useful / pretty useless (delete as applicable)**\r\n\r\nIf we classed everyone with BMI_score >10 as at risk of obesity. How often would we be right and wrong?\r\n\r\n```\r\nobese <- phen$BMIcat\r\nlevels(obese) <- c(\"control\", \"obese\", \"control\", \"control\")\r\nrisk <- factor(BMI_score)\r\nlevels(risk) <- c(\"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \">10\", \">10\", \">10\")\r\ntable(obese, risk)\r\n```\r\n<br><br>\r\n> **Give the numbers in each category:  \r\ngiven low risk prediction & did not become obese:  \r\ngiven low risk prediction & did become obese:  \r\ngiven high risk prediction & did become obese:  \r\ngiven high risk prediction & did not become obese: \r\n<br><br> \r\nQuestion: what proportion of the time would you be right?**\r\n\r\n<br><br>\r\nYou are only going to be right 57% of the time. So for an individual you can make a prediction, but it’s not much better than flipping a coin\r\n\r\nWhat about if you took BMI_score>=13 as the cut-off?\r\n\r\n```\r\nrisk <- factor(BMI_score)\r\nlevels(risk) <- c(\"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \">10\")\r\ntable(obese, risk)\r\n```\r\n<br><br>\r\n> **Give the numbers in each category:  \r\ngiven low risk prediction & did not become obese:  \r\ngiven low risk prediction & did become obese:  \r\ngiven high risk prediction & did become obese:  \r\ngiven high risk prediction & did not become obese:**\r\n\r\n<br><br>\r\nIn this dataset for the 2 people you predicted would be obese, you would be right, but you would have incorrectly told 3524 people that they were not in the high risk group.\r\n\r\n<br><br>\r\n> **Question: What proportion of people have a genetic risk score>=13?  \r\nCan we consider this a similar situation as the rare high penetrant mutations you were considering in the other part of this practical?**",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}