{
  "name": "Calculating an Individual's Genetic Risk",
  "tagline": "from association to prediction",
  "body": "This handout can be found here: https://epxlp.github.io/individual_genetic_risk/\r\n\r\nThere are many ways in which you can estimate an individual’s risk of a particular disease or predict their likely trait value. How you do this will depend on the trait, the circumstances of the individual and the reason for wanting to make such a prediction.\r\n\r\nIn today’s session we will demonstrate estimating risk and predicting trait values in a variety of settings using different types of information.\r\n\r\n\r\n# The data\r\nBecause we have our genes from birth, we could use an individual’s genetic data to estimate their risk having a certain disease later in life. In practice you might be more interested in doing this for cancer or heart disease, but we’ll do this for a trait that you have data for: **BMI/obesity**.\r\n\r\n# Recapping association results\r\nIn the GWAS exercise in unit 2 you found a number of genetic variants associated with BMI. \r\nLet’s start by reminded ourselves of the association evidence between being BMI and the associated SNPs.\r\n\r\n\r\n| SNP\t| CHR\t| BP\t| A1\t| BETA\t| P\t| MAF | var_exp |\r\n| ---\t| ---\t| ---\t| ---\t| ---\t| ---\t| ---\t| ---\t|\r\n| rs12748679\t| 1\t| 72644585\t| C\t| -0.598\t| 1.3E-10\t| 0.205\t| 0.0038 |\r\n| rs630372\t| 1\t| 177885762\t| A\t| 0.687\t| 5.5E-15\t| 0.236\t| 0.0055 |\r\n| rs2867125\t| 2\t| 622827\t| T\t| -0.606\t| 1.1E-09\t| 0.168\t| 0.0033 |\r\n| rs13130484\t| 4\t| 45175691\t| T\t| 0.482\t| 2.2E-10\t| 0.434\t| 0.0037 |\r\n| rs2920930\t| 8\t| 76733973\t| T\t| -0.470\t| 1.1E-08\t| 0.296\t| 0.0030 |\r\n| rs8050136\t| 16\t| 53816275\t| A\t| 0.594\t| 9.5E-15\t| 0.395 | 0.0055 |\r\n| rs12970134\t| 18\t| 57884750\t| A\t| 0.950\t| 4.0E-29\t| 0.267\t| 0.0114 |\r\n\r\n\r\n<br><br>\r\n> **Task: Examine the strength of the evidence for the association (P-value), the magnitude of the association (beta/OR) and the variance in BMI explained for each of these SNPs, that you estimated in unit 2.  \r\nHow convinced are you that these variants are associated with BMI/being overweight?**\r\n\r\n<br><br>\r\nSome of these are very strong associations. p=4e-29 is extremely strong evidence of an association. Despite this the effect sizes and the variance explained are quite small, explaining at most 1% of variance (and 3.6% together). \r\n\r\n<br><br>\r\n> **Question: These variants are all associated with being overweight, but what determines how good a variant is for prediction?**\r\n\r\n<br><br>\r\n**BUT – these only tell us how useful a genotype is ‘on average’ in the population. How useful a genotype is for prediction for an individual also depends on the individual’s genotype.\r\nSome variants might have very large effect, but be extraordinarily rare. This variant would have a low variance explained, but for someone who had this genotype, this would be very informative. Discuss this with a neighbour**\r\n\r\n# Generating a genetic risk score\r\n\r\nFirst we are going to generate a file that details the SNPs we want to use in the genetic risk score. Copy the following command and check that the snps_for_score.txt file is created.\r\n\r\n```\r\necho 'rs571312        A       1\r\nrs630372        A       1\r\nrs8050136       A       1\r\nrs12748679      T       1\r\nrs13130484      T       1\r\nrs2867125       C       1\r\nrs2920930       G       1' >  ~/ibsc_unit2/data/snps_for_score.txt\r\n```\r\n\r\nUse this command to generate a risk score for each person in the sample:\r\n\r\n```\r\nplink --bfile ~/ibsc_unit2/data/geno_qc --score ~/ibsc_unit2/data/snps_for_score.txt --out ~/ibsc_unit2/data/BMI_score\r\n```\r\n\r\nNow we will load the data into R\r\n\r\n```\r\nscore <- read.table(“~/ibsc_unit2/data/BMI_score.profile”, header=T)\r\nphen <- read.table(“~/ibsc_unit2/data/phen_clean.txt”)\r\n```\r\nRun the following commands to investigate the distribution of the genetic risk score\r\n```\r\nBMI_score <- score$CNT2\r\nhist(BMI_score)\r\nhist(BMI_score[phen$BMIcat==\"underweight\" | phen$BMIcat==\"healthy\"], col=rgb(1,0,0,0.5), xlim=c(0,14), ylim=c(0,600), main = \"BMI categories\", xlab=\"genetic_score\")\r\nhist(BMI_score[phen$BMIcat==\"obese\"], col=rgb(0,0,1,0.5), add=T)\r\n```\r\n\r\n# Population-level predictions\r\n\r\nWhat is the difference in obesity risk between those in the top 5% and bottom 5% of the score?\r\n```\r\nquantile(BMI_score, c(.05, .95))\r\nsum(phen$BMIcat==\"obese\" & BMI_score<5)/sum(BMI_score<5)\r\nsum(phen$BMIcat==\"obese\" & BMI_score>10)/sum(BMI_score>10)\r\n```\r\n\r\nThere seems to be quite a significant difference in risk. Those in the bottom 5% of the risk score have only a 30% risk of being obese, whilst those in the top 5% of the risk score have a 60% risk of being obese.\r\n\r\n<br><br>\r\n> **Question: Do you think it would be an economically effective strategy to target an intervention only at children that were in the top 5% of the risk score?  \r\nAlthough this is unlikely to happen for an outcome such as BMI, think about if the outcome were cancer or Alzheimer’s disease.  \r\nDiscuss this with a neighbour**\r\n\r\n<br><br>\r\n**As a genetic risk score increases there is a sliding scale of increased risk, but any health policies would likely have to define a threshold and this would have sensitivity and specificity implications.**\r\n\r\n# Individual level prediction\r\n\r\nThere’s clearly a difference in the genetic_score distribution between healthy and underweight versus obese individuals. However, if I told you someone had a genetic score of 4, what would that tell you?\r\n\r\n```\r\ntable (BMI_score, phen$BMIcat)\r\nsummary(phen$BMI[BMI_score==4])\r\nboxplot(phen$BMI~BMI_score)\r\n```\r\n\r\nOf 335 people in this category: 7% are underweight, 27% are healthy, 35% are overweight, 32% are obese. So you might say that they are quite likely to be overweight or obese, but the range of BMIs for people in this category is very wide (11.5 to 43.3), so it would be difficult to predict their BMI with any accuracy.\r\n\r\n\r\nCompare the mean BMIs of people at the top and bottom of the central 90%\r\n```\r\nquantile(BMI_score, c(.05, .95))\r\nsummary(phen$BMI[BMI_score==5])\r\nsummary(phen$BMI[BMI_score==10])\r\n```\r\n\r\n90% of people fall between BMI_scores of 5 and 10, the mean BMI difference between the top and bottom of this range is: 2.81kg/m2 BMI=30 versus BMI=27. \r\n\r\n<br><br>\r\n> **For the majority of people knowing your BMI score is very useful / somewhat useful / pretty useless (delete as applicable)**\r\n\r\nIf we classed everyone with BMI_score >10 as at risk of obesity. How often would we be right and wrong?\r\n\r\n```\r\nobese <- phen$BMIcat\r\nlevels(obese) <- c(\"control\", \"obese\", \"control\", \"control\")\r\nrisk <- factor(BMI_score)\r\nlevels(risk) <- c(\"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \">10\", \">10\", \">10\")\r\ntable(obese, risk)\r\n```\r\n<br><br>\r\n> **Give the numbers in each category:  \r\ngiven low risk prediction & did not become obese:  \r\ngiven low risk prediction & did become obese:  \r\ngiven high risk prediction & did become obese:  \r\ngiven high risk prediction & did not become obese: \r\n<br><br> \r\nQuestion: what proportion of the time would you be right?**\r\n\r\n<br><br>\r\nYou are only going to be right 57% of the time. So for an individual you can make a prediction, but it’s not much better than flipping a coin\r\n\r\nWhat about if you took BMI_score>=13 as the cut-off?\r\n\r\n```\r\nrisk <- factor(BMI_score)\r\nlevels(risk) <- c(\"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \"<=10\", \">10\")\r\ntable(obese, risk)\r\n```\r\n<br><br>\r\n> **Give the numbers in each category:  \r\ngiven low risk prediction & did not become obese:  \r\ngiven low risk prediction & did become obese:  \r\ngiven high risk prediction & did become obese:  \r\ngiven high risk prediction & did not become obese:**\r\n\r\n<br><br>\r\nIn this dataset for the 2 people you predicted would be obese, you would be right, but you would have incorrectly told 3524 people that they were not in the high risk group.\r\n\r\n<br><br>\r\n> **Question: What proportion of people have a genetic risk score>=13?  \r\nCan we consider this a similar situation as the rare high penetrant mutations you have considered in other parts of this unit?**\r\n\r\n# Published examples\r\nSome studies have attempted to predict BMI from genotype (e.g. Speliotes 2010, Nature Genetics 42(11):937-948)\r\n\r\n<img src=\"fig1.png\">\r\n\r\nFig a. Mean BMI according to risk score - Note there is an increase of ~3kg/m2 between the top and bottom of the genetic risk score\r\nFig b. Displays the ROC curve for 2 prediction models. Solid line includes age, age2 and sex (AUC=0.515), dashed line includes age, age2, sex and 32 BMI SNPs (AUC=0.575).\r\n\r\n<br><br>\r\n> **Question: Does including the SNPs improve the prediction of obesity?**\r\n\r\n<br><br>\r\nAnother study Morandi PloS ONE 2012, 7(11):e49919 compared genetic prediction to prediction using traditional risk factors.\r\n\r\n<img src=\"fig2.png\">\r\n\r\n\r\nTurquoise= genetic risk score, Red= traditional risk factors, dark blue= combined traditional risk factprs and genetic risk score.\r\nIntegrated discrimination improvement (IDI) = 0.5%, shows the possible accuracy improvement associated with adding the genetic score to the traditional risk factors alone. \r\n\r\n<br><br>\r\n> **Question: Is there any improvement including SNPs in the prediction?**\r\n\r\n<br><br>\r\n\r\nLook up this study now and see which traditional risk factors were included in the model.\r\n\r\n<br><br>\r\n> **Why does a prediction that includes ‘parental BMI’ do just as well as one that includes SNPs?**\r\n\r\n<br><br>\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}